import React, {
  Dispatch,
  SetStateAction,
  useContext,
  useEffect,
  useReducer,
  useState,
} from 'react';
import { Recipe } from '../util/recipe';

const PersonContext = React.createContext<
  [string, Dispatch<SetStateAction<string>>]
>(['', (e) => e]);

function reducer(state, action) {
  switch (action.type) {
    case 'rename':
      return { ...state, firstname: action.data };
      break;
  }
}

const Context: React.FC = () => {
  const [state, dispatch] = useReducer(reducer, {
    firstname: 'Klaus',
  });
  return (
    <div>
      <PersonContext.Provider value={[state, dispatch]}>
        <Intermediate />
      </PersonContext.Provider>
    </div>
  );
};

const Intermediate: React.FC = () => {
  return <Child />;
};

const Child: React.FC = () => {
  const [state, dispatch] = useContext(PersonContext);
  useEffect(() => {
    setTimeout(() => {
      dispatch({ type: 'rename', data: 'Claudia' });
    }, 1000);
  });
  return <div>Child: {state}</div>;
};

export default Context;
